<?xml version="1.0" encoding="utf-8"?>

<launch>
  <arg name="use_sim_time"  default="true" />
  <arg name="param_file" default="$(find nvblox_ros)/config/min_parameters.yaml"/>
  <arg name="rviz" default="false" />
  <arg name="projective_integrator_max_integration_distance_m" default="10" />
  <arg name="projective_integrator_truncation_distance_vox" default="10" />

  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find nvblox_ros)/rviz/panopt.rviz" if="$(arg rviz)"/>

  <node pkg="nvblox_ros" type="nvblox_node" name="nvblox_node" respawn="false" output="screen" >
    <rosparam file="$(arg param_file)"/>
    <remap from="depth/image" to="/crl_rzr/multisense_front/left/disparity" />
    <remap from="depth/camera_info" to="/crl_rzr/multisense_front/left/image_rect/camera_info" />
    <remap from="right/camera_info" to="/crl_rzr/multisense_front/right/image_rect/camera_info" />

    <remap from="color/image" to="/crl_rzr/multisense_front/aux/image_color" />
    <remap from="color/camera_info" to="/crl_rzr/multisense_front/aux/image_color/camera_info" />

    <!-- Anything here ovewrites the parameters in the config file. -->
    <param name="global_frame" value="map" />
    <param name="pose_frame" value="crl_rzr/base_link" />
    <param name="map_clearing_frame_id" value="crl_rzr/base_link" />
    <param name="slice_visualization_attachment_frame_id" value="crl_rzr/base_link" />
    <param name="weighting_mode" value="constant" />
    <param name="use_sim_time" value="$(arg use_sim_time)" />
    <param name="use_lidar" value="false" />
    <param name="voxel_size" value="0.1" />
    <param name="esdf_slice_height" value="1.5" />
    <param name="esdf_2d" value="true" />
    <param name="esdf_2d_min_height" value="1.0" />
    <param name="esdf_2d_max_height" value="2.0" />
    <param name="max_depth_update_hz" value="20" />
    <param name="max_color_update_hz" value="20" />
    <param name="use_color" value="false" />
    <param name="use_topic_transforms" value="true" />
    <param name="mesh_update_rate_hz" value="15.0" />
    <param name="map_clearing_radius_m" value="50.0" />
    <param name="projective_integrator_max_integration_distance_m"
        value="$(arg projective_integrator_max_integration_distance_m)" />
    <param name="projective_integrator_truncation_distance_vox"
        value="$(arg projective_integrator_truncation_distance_vox)" />
  </node>

</launch>
